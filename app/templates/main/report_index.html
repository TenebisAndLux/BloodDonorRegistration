<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система учета доноров крови - Выгрузка отчетов</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main_styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/report_styles.css') }}">
</head>
<body>
<div class="header">
    <div class="hospital-name">Больница имени Н.И. Пирогова</div>
    <div class="name-container" onmouseenter="showLogoutButton()" onmouseleave="hideLogoutButton()">
        <div class="name" onfocus="showLogoutButton()">
            Петрова А.С. (Администратор)
        </div>
        <div class="exit-button" style="display: none" onmouseenter="showLogoutButton()"
             onmouseleave="hideLogoutButton()" onclick="location.href='/login'">Выход
        </div>
    </div>
</div>

<div class="content-wrapper">
    <div class="reports-container">
        <h2>Формирование отчетов</h2>

        <div class="report-section">
            <h3>1. Отчет о доноре</h3>
            <div class="report-content">
                <div class="preview-content" id="preview-content-1">
                    <p>Предпросмотр отчета о доноре</p>
                </div>
                <form id="report1-form" class="report-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div class="form-group">
                        <label for="collectiontypecode">Код типа сбора</label>
                        <select id="collectiontypecode" name="collectiontypecode" required>
                            <option value="">Выберите тип сбора</option>
                            {% for type in collection_types %}
                            <option value="{{ type.collectiontypecode }}">{{ type.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="institutioncode">Код учреждения</label>
                        <select id="institutioncode" name="institutioncode" required>
                            <option value="">Выберите учреждение</option>
                            {% for institution in institutions %}
                            <option value="{{ institution.institutioncode }}">{{ institution.nameofinstitution }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="numberstock">Номер запаса</label>
                        <select id="numberstock" name="numberstock" required>
                            <option value="">Выберите номер запаса</option>
                            {% for stock in stocks %}
                            <option value="{{ stock.numberstock }}">{{ stock.numberstock }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="number">Номер</label>
                        <select id="number" name="number" required>
                            <option value="">Выберите номер</option>
                            {% for num in numbers %}
                            <option value="{{ num.number }}">{{ num.number }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="button" onclick="generateReport(1)">Сформировать DOCX</button>
                </form>
            </div>
        </div>

        <div class="report-section">
            <h3>2. Сводный отчет по учреждению</h3>
            <div class="report-content">
                <div class="preview-content" id="preview-content-2">
                    <p>Предпросмотр сводного отчета</p>
                </div>
                <form id="report2-form" class="report-form">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div class="form-group">
                        <label for="institutioncode2">Учреждение</label>
                        <select id="institutioncode2" name="institutioncode" required>
                            <option value="">Выберите учреждение</option>
                            {% for institution in institutions %}
                            <option value="{{ institution.institutioncode }}">{{ institution.nameofinstitution }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="start_date">Дата начала периода</label>
                        <input type="date" id="start_date" name="start_date" required>
                    </div>
                    <div class="form-group">
                        <label for="end_date">Дата окончания периода</label>
                        <input type="date" id="end_date" name="end_date" required>
                    </div>
                    <button type="button" onclick="generateReport(2)">Сформировать DOCX</button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="footer">
    <span>Разработка и поддержка - ООО "DONOR MIRROR"</span>
</div>

<script src="{{ url_for('static', filename='js/reportScripts.js') }}"></script>
</body>
</html>